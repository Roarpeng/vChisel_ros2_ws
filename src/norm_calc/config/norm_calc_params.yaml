norm_calc:
  ros__parameters:
    # ==================== 区域与网格 ====================
    BOX_LEN: 0.05
    BOX_ROW: 4
    BOX_COLUMN: 6
    # 工作空间
    XMIN: -0.15
    XMAX: 0.15
    YMIN: -0.1
    YMAX: 0.1
    ZMIN: 0.2
    ZMAX: 0.8
    BORDER_WIDTH: 0.03
    
    # ==================== 预处理 ====================
    SEARCH_RADIUS: 0.02        # 法向估计半径（从0.015增加到0.02，放宽条件）
    SEARCH_NUM_TH: 20          # 离群点去除阈值（从30降低到20，放宽条件）

    # ==================== 核心策略参数 ====================
    # 严格模式 (第一次尝试：只打完美的点)
    STRICT_NORM_TH: 0.90       # cos(16度)，要求非常垂直
    STRICT_HOLE_DIST: 0.035    # 离空洞/旧点至少 2cm（从0.05降低到0.02）
    STRICT_CURV_TH: 0.08      # 表面必须非常平整

    # 宽松模式 (第二次尝试：允许次优点)
    RELAXED_NORM_TH: 0.82      # cos(35度)，允许斜坡（从0.87降低到0.82，放宽条件）
    RELAXED_HOLE_DIST: 0.025   # 离空洞至少 1.5cm（从0.035降低到0.015）
    RELAXED_CURV_TH: 0.12      # 允许表面稍微粗糙
    
    # ==================== 评分权重 ====================
    HEIGHT_WEIGHT: 1.0         # 降低高度权重，平面情况下优先垂直角度
    CURV_WEIGHT: 5.0           # 优先打平整（从2.0增加到5.0，大幅提高平面性权重）
    ANGLE_WEIGHT: 15.0         # 大幅提高角度权重，确保垂直度（从5.0增加到15.0，极度强调平面垂直度）
    CENTER_WEIGHT: 5.0         # 优先打网格中心 (防止边缘效应)
     # ==================== 凸起处理策略参数 ====================
    PROTRUSION_TH: 0.03       # (米) Z轴极差超过3cm，则判定为存在凸起（从0.02增加到0.03，更严格）
    TIP_CROP_RATIO: 0.25      # 遇到凸起时，剔除顶部 25% 的高度 (避开滑动的顶点)
    BASE_CROP_RATIO: 0.10     # 剔除底部 10% 的高度 (避开太深的位置)

    # ==================== 随机模式参数 ====================
    # 用于严格模式和宽松模式都失败时的备用策略
    RANDOM_OFFSET_RANGE: 0.02  # 随机位置偏移范围（米，默认2cm）
    RANDOM_ANGLE_RANGE: 0.14   # 随机法向角度范围（弧度，默认20°）

    # ==================== 平面面积阈值（平方米） ====================
    # 基于凸包面积判断平面/凹凸面的三段式策略
    # 注意：5cm×5cm方格的总面积是25cm² = 0.0025m²
    PLANE_AREA_HIGH: 0.0015   # 15cm² - 平面模式阈值（面积≥此值使用严格标准）
    PLANE_AREA_LOW: 0.0008    # 8cm² - 凹凸面模式阈值（面积<此值使用宽松标准）
    # 8-15cm²之间使用混合标准（中间值）

    # 混合模式参数（用于8-15cm²之间的缓冲区）
    HYBRID_NORM_TH: 0.86      # 混合法向阈值（介于严格0.90和宽松0.82之间）
    HYBRID_HOLE_DIST: 0.0175  # 混合避障距离（介于0.02和0.015之间）
    HYBRID_CURV_TH: 0.085     # 混合曲率阈值（介于0.07和0.10之间）

    # ==================== 手眼标定矩阵 ====================
    # 相机坐标系到工具坐标系的 4x4 齐次变换矩阵
    # 格式：按行优先存储
    # 单位：位置为米（m），旋转为方向余弦矩阵
    hand_eye_calibration:
      # 第一行：[R11, R12, R13, Tx]
      row1: [0.002136129093849748, 0.0131617748027531, 0.9999110983665177,-0.3592755296727744]
      # 第二行：[R21, R22, R23, Ty]
      row2: [0.9998109504292265, -0.01935263737141502,-0.001881177444387261, -0.03444265988510906]
      # 第三行：[R31, R32, R33, Tz]
      row3: [0.01932615725645348,0.9997260840404296, -0.01320062630660779, -0.2227647594718163]
      # 第四行：[0, 0, 0, 1]
      row4: [0.0, 0.0, 0.0, 1.0]

    # 标定元数据
    calibration_metadata:
      date: "2026-01-05"
      marker_id: 123
      marker_size: 0.10  # 米
      data_count: 15  # 采集的数据组数
    
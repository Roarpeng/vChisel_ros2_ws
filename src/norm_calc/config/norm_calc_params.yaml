# 法向量计算节点参数配置文件
# 用于凿击点位智能选择系统
norm_calc:
  ros__parameters:
    # ==================== 凿子盒区域划分参数 ====================
    BOX_LEN: 0.05              # 凿子盒边长(米)，建议范围：0.03-0.08，越小点位越密集
    BOX_ROW: 4                 # 凿子盒行数，建议范围：3-6
    BOX_COLUMN: 6              # 凿子盒列数，建议范围：4-8
    
    # ==================== 工作空间边界参数 ====================
    XMIN: -0.15                # X轴最小值(米)，工作空间左边界
    XMAX: 0.15                 # X轴最大值(米)，工作空间右边界  
    YMIN: -0.1                 # Y轴最小值(米)，工作空间前边界
    YMAX: 0.1                  # Y轴最大值(米)，工作空间后边界
    ZMIN: 0.2                  # Z轴最小值(米)，工作空间下边界
    ZMAX: 0.6                  # Z轴最大值(米)，工作空间上边界
    BORDER_WIDTH: 0.03         # 边界扩展宽度(米)，建议范围：0.02-0.05，用于边缘处理
    
    # ==================== 点位筛选核心参数 ====================
    NORM_TH: 0.7              # 法向量阈值，建议范围：0.80-0.95，值越大要求表面越垂直
                                # 从0.85降低到0.75，放宽表面垂直度要求以增加有效点
    AFFECT_RADIUS: 0.01        # 点位避让半径(米)，建议范围：0.002-0.05，防止点位过于密集
    
    # ==================== 评分权重参数 ====================
    HEIGHT_WEIGHT: 3.0         # 高度权重，建议范围：1.0-5.0，值越大越偏好低位置
                                # 从1.0增加到3.0，更重视高度因素
    CURV_WEIGHT: 2.0           # 曲率权重，建议范围：1.0-5.0，值越大越偏好平坦表面
                                # 从1.0增加到2.0，更重视表面平坦度
    ANGLE_WEIGHT: 1.0          # 角度权重，建议范围：1.0-5.0，值越大越偏好垂直表面
    
    # ==================== 点云预处理参数 ====================
    SEARCH_RADIUS: 0.03        # 搜索半径(米)，用于法向量计算和边缘点剔除
    SEARCH_NUM_TH: 50          # 搜索数量阈值，邻域内最少点数，低于此值认为是边缘点
                                # 从100降低到50，减少边缘点剔除
    
    # ==================== 边缘网格模式参数 ====================
    TH_DEEP: 0.6               # 深度阈值(米)，超过此值认为是深坑，建议范围：0.3-0.5
                                # 从0.4增加到0.6，放宽深度限制
    TH_DEEPNORM: 0.7           # 深度法向量阈值，深坑区域的法向量要求
                                # 从0.8降低到0.7，放宽深坑区域要求
    TH_HALF: 50                # 半满阈值，栅格内点数低于此值认为是稀疏区域
    TH_FULL: 80                # 全满阈值，栅格内点数超过此值认为是密集区域
                                # 从100降低到80，减少密集区域要求
    TH_ANGLE: 0.99             # 角度阈值，用于区分斜坡和平面，建议范围：0.90-0.99
                                # 从0.95增加到0.99，更严格地识别平面

# ==================== 参数调整指南 ====================
# 
# 【高精度场景】需要更精确的点位选择：
# - 减小 BOX_LEN (0.03-0.04) 增加点位密度
# - 增大 NORM_TH (0.90-0.95) 提高表面垂直度要求
# - 减小 AFFECT_RADIUS (0.002-0.005) 允许更近的点位间距
#
# 【粗糙表面场景】表面不平整，需要更宽松的条件：
# - 减小 NORM_TH (0.80-0.85) 降低法向量要求
# - 减小 TH_FULL (30-50) 降低点数要求
# - 增大 CURV_WEIGHT (3.0-5.0) 更重视曲率因素
#
# 【密集点云场景】点云质量很好，可以更严格：
# - 增大 SEARCH_NUM_TH (150-200) 提高边缘点剔除标准
# - 增大 TH_FULL (100-150) 提高密集区域要求
# - 减小 HEIGHT_WEIGHT (1.0-1.5) 降低高度偏好
#
# 【稀疏点云场景】点云质量较差，需要更宽松：
# - 减小 SEARCH_NUM_TH (50-80) 降低边缘点剔除标准
# - 减小 TH_FULL (30-50) 降低密集区域要求
# - 增大 HEIGHT_WEIGHT (3.0-5.0) 更重视高度因素
#
# 【快速处理场景】需要提高处理速度：
# - 增大 BOX_LEN (0.06-0.08) 减少计算量
# - 增大 SEARCH_RADIUS (0.04-0.05) 提高搜索效率
# - 减小 BOX_ROW/COLUMN 减少区域数量
#
# 【安全优先场景】需要更大的安全距离：
# - 增大 AFFECT_RADIUS (0.05-0.1) 增加点位间距
# - 增大 BORDER_WIDTH (0.04-0.06) 扩大安全边界
# - 增大 ANGLE_WEIGHT (3.0-5.0) 更重视表面角度